<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Russell Vector Mapper</title>
    <style>
        body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background: #ffffff; color: #111; display: flex; margin: 0; height: 100vh; }
        #sidebar { width: 360px; background: #fdffdf; padding: 25px; border-right: 1px solid #ddd; overflow-y: auto; height: 100%; box-shadow: inset -5px 0 10px rgba(0,0,0,0.02); }
        #viewer { flex-grow: 1; display: flex; justify-content: center; align-items: center; background: #fff; position: relative; }
        canvas { background: #fff; }
        .input-group { margin-bottom: 15px; background: #fff; padding: 12px; border: 1px solid #eee; border-radius: 4px; }
        label { display: block; font-size: 0.7em; font-weight: bold; color: #555; text-transform: uppercase; margin-bottom: 5px; }
        input { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 3px; box-sizing: border-box; }
        .btn-add { width: 100%; padding: 12px; background: #000; color: #fff; border: none; font-weight: bold; cursor: pointer; border-radius: 4px; }
        .emotion-card { display: flex; align-items: center; background: #fff; padding: 10px; margin-top: 8px; border: 1px solid #eee; border-left: 5px solid var(--c); font-size: 0.85em; }
        .remove-btn { margin-left: auto; color: red; cursor: pointer; font-weight: bold; }
        .save-btn { margin-top: 20px; background: none; border: 1px solid #000; padding: 10px; width: 100%; cursor: pointer; font-weight: bold; }
        .desc { font-size: 0.65em; color: #888; margin-top: 4px; font-style: italic; }
    </style>
</head>
<body>

<div id="sidebar">
    <h2 style="font-size: 1.2em; border-bottom: 2px solid #000; padding-bottom: 10px;">Vector Input</h2>
    
    <div class="input-group">
        <label>Affective Label</label>
        <input type="text" id="name" placeholder="e.g., Happy">
    </div>

    <div class="input-group">
        <label>Angle (θ: 0-360°)</label>
        <input type="number" id="angle" value="0">
        <div class="desc">The "Hue" or Quality of the emotion.</div>
    </div>

    <div class="input-group">
        <label>Consensus (P-Value: 0.0 - 1.0)</label>
        <input type="number" id="p_val" value="0.8" step="0.05" min="0" max="1">
        <div class="desc">Vector Length. High P = Clear Definition (Perimeter).</div>
    </div>

    <div class="input-group">
        <label>Fuzziness (Overlap Radius)</label>
        <input type="range" id="fuzz" min="10" max="100" value="40">
        <div class="desc">Visualizes the "Fuzzy Set" overlap.</div>
    </div>

    <div class="input-group">
        <label>Color</label>
        <input type="color" id="color" value="#3366ff">
    </div>

    <button class="btn-add" onclick="addEmotion()">PLOT VECTOR</button>

    <div id="list" style="margin-top: 30px;"></div>
    <button class="save-btn" onclick="saveImage()">SAVE MAP (.PNG)</button>
</div>

<div id="viewer">
    <canvas id="canvas"></canvas>
</div>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let emotions = [];

    function resize() {
        const size = Math.min(window.innerWidth - 420, window.innerHeight - 100);
        canvas.width = size;
        canvas.height = size;
        draw();
    }
    window.onresize = resize;
    resize();

    function addEmotion() {
        const e = {
            id: Date.now(),
            name: document.getElementById('name').value || '?',
            angle: parseFloat(document.getElementById('angle').value),
            p: parseFloat(document.getElementById('p_val').value),
            fuzz: parseFloat(document.getElementById('fuzz').value),
            color: document.getElementById('color').value,
            visible: true
        };
        emotions.push(e);
        updateUI();
        draw();
    }

    function updateUI() {
        const list = document.getElementById('list');
        list.innerHTML = '';
        emotions.forEach(e => {
            const div = document.createElement('div');
            div.className = 'emotion-card';
            div.style.setProperty('--c', e.color);
            div.innerHTML = `
                <input type="checkbox" ${e.visible ? 'checked' : ''} onchange="toggle(${e.id})">
                <strong>${e.name}</strong> <span style="margin-left:8px; color:#999;">${e.angle}° (P:${e.p})</span>
                <span class="remove-btn" onclick="remove(${e.id})">×</span>
            `;
            list.appendChild(div);
        });
    }

    function toggle(id) {
        const e = emotions.find(x => x.id === id);
        e.visible = !e.visible;
        draw();
    }

    function remove(id) {
        emotions = emotions.filter(x => x.id !== id);
        updateUI();
        draw();
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const cx = canvas.width / 2;
        const cy = canvas.height / 2;
        const radius = canvas.width * 0.4;

        // Draw Neutral Grid
        ctx.strokeStyle = '#eee'; ctx.lineWidth = 1;
        ctx.beginPath(); ctx.arc(cx, cy, radius, 0, Math.PI*2); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(cx-radius, cy); ctx.lineTo(cx+radius, cy); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(cx, cy-radius); ctx.lineTo(cx, cy+radius); ctx.stroke();

        ctx.fillStyle = '#bbb'; ctx.font = 'bold 10px Arial';
        ctx.fillText('HIGH AROUSAL', cx - 35, cy - radius - 10);
        ctx.fillText('LOW AROUSAL', cx - 35, cy + radius + 20);
        ctx.fillText('PLEASURE', cx + radius + 10, cy + 4);
        ctx.fillText('DISPLEASURE', cx - radius - 80, cy + 4);

        emotions.forEach(e => {
            if (!e.visible) return;
            const rad = (e.angle * Math.PI) / 180;
            const vLen = radius * e.p; // Length is determined by P-Value
            const targetX = cx + Math.cos(rad) * vLen;
            const targetY = cy + Math.sin(rad) * vLen;

            // 1. Draw Fuzzy Set (The Disk Gradient)
            const fuzzGrad = ctx.createRadialGradient(targetX, targetY, 0, targetX, targetY, e.fuzz);
            fuzzGrad.addColorStop(0, e.color + '66'); // 40% opacity
            fuzzGrad.addColorStop(1, 'transparent');
            
            ctx.fillStyle = fuzzGrad;
            ctx.beginPath();
            ctx.arc(targetX, targetY, e.fuzz, 0, Math.PI*2);
            ctx.fill();

            // 2. Draw Vector Line
            ctx.strokeStyle = e.color;
            ctx.lineWidth = 2;
            ctx.setLineDash([2, 2]); // Dotted to represent theoretical vector
            ctx.beginPath();
            ctx.moveTo(cx, cy);
            ctx.lineTo(targetX, targetY);
            ctx.stroke();
            ctx.setLineDash([]);

            // 3. Draw Point
            ctx.fillStyle = e.color;
            ctx.beginPath();
            ctx.arc(targetX, targetY, 4, 0, Math.PI*2);
            ctx.fill();

            // 4. Label
            ctx.fillStyle = '#000';
            ctx.font = 'bold 12px Arial';
            ctx.fillText(e.name.toUpperCase(), targetX + 10, targetY - 10);
        });
    }

    function saveImage() {
        const link = document.createElement('a');
        link.download = 'russell.png';
        link.href = canvas.toDataURL();
        link.click();
    }
</script>

</body>
</html>
</script>
</body>
</html>
